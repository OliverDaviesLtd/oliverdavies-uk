workspace('oliverdavies-uk'):
  description: My personal website codebase.

attribute('database'):
  database: drupal
  password: drupal
  username: drupal
attribute('drupal.docroot'): web
attribute('frontend'):
  build: npm run prod
  dev: npm run dev
  install: npm ci
  path: themes/custom/opdavies
  watch: npm run watch
attribute('mysql'):
  image: mariadb
  version: 10
attribute('node.version'): 12
attribute('php.version'): 7.4

command('composer %'):
  env:
    COMPOSE_PROJECT_NAME: = @('namespace')
  exec: |
    #!bash|=
    ws exec composer ={ input.argument('%') }

command('drush %'):
  env:
    COMPOSE_PROJECT_NAME: = @('namespace')
  exec: |
    #!bash|=
    ws exec bin/drush ={ input.argument('%') }

command('install'):
  env:
    COMPOSE_PROJECT_NAME: = @('namespace')
  exec: |
    #!bash
    ws composer install
    ws theme install
    ws theme dev

command('frontend dev'):
  env:
    COMPOSE_PROJECT_NAME: = @('namespace')
  exec: |
    #!bash|@
    passthru docker-compose run --rm -w /node/@('frontend.path') node @('frontend.dev')

command('frontend build'):
  env:
    COMPOSE_PROJECT_NAME: = @('namespace')
  exec: |
    #!bash|@
    passthru docker-compose run --rm -w /node/@('frontend.path') node @('frontend.build')

command('frontend install'):
  env:
    COMPOSE_PROJECT_NAME: = @('namespace')
  exec: |
    #!bash|@
    passthru docker-compose run --rm -w /node/@('frontend.path') node @('frontend.install')

command('frontend watch'):
  env:
    COMPOSE_PROJECT_NAME: = @('namespace')
  exec: |
    #!bash|@
    passthru docker-compose run --rm -w /node/@('frontend.path') node @('frontend.watch')

command('phpunit %'):
  env:
    COMPOSE_PROJECT_NAME: = @('namespace')
  exec: |
    #!bash|=
    ws exec bin/phpunit ={ input.argument('%') }

import:
  - tools/workspace/config/*.yml
